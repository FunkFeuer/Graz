<VirtualHost *:443>
  ServerName nodedb.ffgraz.net
  ServerAdmin admin@graz.funkfeuer.at
  DocumentRoot /srv/nodedb/staging/active/www
  
  AddDefaultCharset     utf-8
  AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript

  SSLEngine on
  SSLCertificateFile    /etc/ssl/certs/nodedb.ffgraz.net.crt
  SSLCertificateKeyFile /etc/ssl/private/nodedb.ffgraz.net.key
  SSLCertificateChainFile /etc/ssl/certs/startcom-bundle.pem
  SSLProtocol           all -SSLv2 -SSLv3
  SSLHonorCipherOrder   On
  SSLCompression        off
  SSLCipherSuite        'EDH+CAMELLIA:EDH+aRSA:EECDH+aRSA+AESGCM:EECDH+aRSA+SHA384:EECDH+aRSA+SHA256:EECDH:+CAMELLIA256:+AES256:+CAMELLIA128:+AES128:+SSLv3:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS:!RC4:!SEED:!ECDSA:CAMELLIA256-SHA:AES256-SHA:CAMELLIA128-SHA:AES128-SHA'

  Alias /media/GTW/ /srv/nodedb/staging/active/tapyr/_GTW/media/
  Alias /media/v/   /srv/nodedb/staging/active/www/app/media/v/
  Alias /media/     /srv/nodedb/staging/active/www/media/

  <Directory /srv/nodedb/staging/active/tapyr/_GTW/media>
    Order    deny,allow
    Allow    from all
    FileETag all
  </Directory>

  <Directory /srv/nodedb/staging/active/www/app/media/v>
    Order    deny,allow
    Allow    from all
  </Directory>

  <Directory /srv/nodedb/staging/active/www/app>
    Order    deny,allow
    Deny     from all
  </Directory>
  <Directory /srv/nodedb/staging/active/www/media>
    Order    deny,allow
    Allow    from all
    FileETag all
  </Directory>

  <Directory /srv/nodedb/staging/active/www>
    DirectoryIndex index.html
  </Directory>

  <FilesMatch "\.(gif|jpe?g|png)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
  </FilesMatch>

  <Directory /srv/nodedb/staging/active/tapyr/_GTW/media/js>
    ExpiresActive On
    ExpiresDefault "access plus 1 week"
  </Directory>

  <Directory /srv/nodedb/staging/active/tapyr/_GTW/media/css>
    ExpiresActive On
    ExpiresDefault "access plus 1 week"
  </Directory>

  <Directory /srv/nodedb/staging/active/www/media/v>
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
  </Directory>
  <Directory /srv/nodedb/staging/active/www/media>
    ExpiresActive On
    ExpiresDefault "access plus 1 day"
  </Directory>


  AddHandler fcgid-script .fcgi
  Options    +ExecCGI

  DefaultMaxClassProcessCount 1
  DefaultMinClassProcessCount 0

  ScriptAliasMatch .* /srv/nodedb/staging/fcgi/nodedb_ffgraz.net__443.fcgi

  CustomLog ${APACHE_LOG_DIR}/nodedb.ffgraz.net-443-access.log combined
  ErrorLog  ${APACHE_LOG_DIR}/nodedb.ffgraz.net-443-error.log
  LogLevel  warn

  UseCanonicalName On
</VirtualHost>
